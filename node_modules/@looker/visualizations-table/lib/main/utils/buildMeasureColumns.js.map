{"version":3,"file":"buildMeasureColumns.js","names":["buildMeasureColumns","measures","config","reduce","cols","measure","i","pivotKey","pivot_key","group","seriesConfig","Array","isArray","series","name","header","label","accessorFn","data","id"],"sources":["../../../src/utils/buildMeasureColumns.ts"],"sourcesContent":["/**\n * Copyright (c) 2023 Google LLC\n * SPDX-License-Identifier: MIT\n */\n\nimport type {\n  SDKRecord,\n  CTable,\n  MeasureMetadata,\n} from '@looker/visualizations-adapters'\nimport type { ColumnDef } from '@tanstack/table-core'\n\n/**\n * Renders dimension columns from fields.dimensions response.\n * @param measures: an array of measure metadata\n * @param config: vis config object\n * @returns A list of measures which are grouped by their pivot key name where applicable.\n */\nexport const buildMeasureColumns = (\n  measures: MeasureMetadata[],\n  config: CTable\n): Record<string, ColumnDef<SDKRecord>[]> => {\n  return measures.reduce<Record<string, ColumnDef<SDKRecord>[]>>(\n    (cols, measure, i) => {\n      const pivotKey = measure.pivot_key || ''\n      const group = cols[pivotKey] || []\n      const seriesConfig = {\n        ...measure,\n        ...(Array.isArray(config.series)\n          ? config.series[i]\n          : config.series?.[measure.name]),\n      }\n\n      return {\n        ...cols,\n        [pivotKey]: [\n          ...group,\n          {\n            header: seriesConfig.label,\n            accessorFn: (data: SDKRecord) => data[measure.name],\n            id: measure.name,\n          },\n        ],\n      }\n    },\n    {}\n  )\n}\n"],"mappings":";;;;;;;;;;;;AAkBO,IAAMA,mBAAmB,GAAG,SAAtBA,mBAAmB,CAC9BC,QAA2B,EAC3BC,MAAc,EAC6B;EAC3C,OAAOD,QAAQ,CAACE,MAAM,CACpB,UAACC,IAAI,EAAEC,OAAO,EAAEC,CAAC,EAAK;IAAA;IACpB,IAAMC,QAAQ,GAAGF,OAAO,CAACG,SAAS,IAAI,EAAE;IACxC,IAAMC,KAAK,GAAGL,IAAI,CAACG,QAAQ,CAAC,IAAI,EAAE;IAClC,IAAMG,YAAY,mCACbL,OAAO,GACNM,KAAK,CAACC,OAAO,CAACV,MAAM,CAACW,MAAM,CAAC,GAC5BX,MAAM,CAACW,MAAM,CAACP,CAAC,CAAC,qBAChBJ,MAAM,CAACW,MAAM,mDAAb,eAAgBR,OAAO,CAACS,IAAI,CAAC,CAClC;IAED,uCACKV,IAAI,4CACNG,QAAQ,gDACJE,KAAK,IACR;MACEM,MAAM,EAAEL,YAAY,CAACM,KAAK;MAC1BC,UAAU,EAAE,oBAACC,IAAe;QAAA,OAAKA,IAAI,CAACb,OAAO,CAACS,IAAI,CAAC;MAAA;MACnDK,EAAE,EAAEd,OAAO,CAACS;IACd,CAAC;EAGP,CAAC,EACD,CAAC,CAAC,CACH;AACH,CAAC;AAAA"}